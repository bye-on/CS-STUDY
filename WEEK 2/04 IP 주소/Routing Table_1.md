# Routing Table_1

# 라우팅 테이블

---

**라우팅(Routing)**

- 네트워크에서 데이터(패킷)를 보낼 때 **최적의 경로를 선택하는 과정**이며 **라우터**가 이를 수행
- 데이터는 보통 출발지에서 목적지로 가는 동안 여러 개의 라우터를 거치며 여러 번의 라우팅을 수행(라우팅은 보통 초당 수백만번 일어남)

**라우터**

- 네트워크 사이에서 데이터를 전달하는 장치이며 보통 둘 이상의 서로 다른 네트워크에 연결
- 데이터(패킷)를 목적지로 보낼 때 최적의 경로를 결정하고 경로가 결정되면 해당 경로로 데이터를 넘겨주는 일(라우팅)을 수행
- 라우팅 테이블을 기반으로 데이터를 다음 목적지에게 전달

**라우팅 테이블**

- 라우터에 들어가 있는 목적지 정보들과 그 목적지로 가기 위한 방법이 들어 있는 리스트
- 게이트웨이와 모든 목적지에 대해 해당 목적지에 도달하기 위해 거쳐야 할 다음 라우터의 정보를 가짐

**구성**

![routing_table.png](routing_table.png)

- 네트워크 대상(Network Destination) :목적지 네트워크의 IP 주소
- 서브넷 마스크(Netmask) :대상 주소를 설명할 때 쓰이는 값
- 게이트웨이(Gateway) : 이 장치와 연결되어있는 홉, 패킷이 전달되는 다음 IP 주소(외부 네트워크와 연결된 장치)
    - 만약 목적지가 로컬 네트워크라면 “연결됨(connected)”라고 표기 되며 다른 네트워크라면 해당 네트워크의 게이트웨이를 가리킴
- 인터페이스(interface) : 게이트웨이로 가기위해 거치는 장치 / 10.0.0.2는 eth3을 통해 접근이 가능
- **메트릭(Metric) :** 우선순위라고도 불리며 패킷 전송을 위해 최적의 경로가 선택되도록 참고되는 값
    - 동일한 라우팅 테이블 요소가 2개 있을 때 이 값이 낮은 요소가 선택. 메트릭은 일반적으로 홉 수(hop count)가 들어가며 지연시간, 처리량 등이 들어갈 수 있음

## **게이트웨이**

---

- 프로토콜 변환기라고도 하며 네트워크와 네트워크를 잇는 장치(라우터와 하는 기능차제가 비슷)
- 서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터나 소프트웨어
- 사용자는 인터넷에 접속하기 위해 수많은 톨게이트인 게이트웨이를 거쳐야 하며 게이트웨이는 서로 다른 네트워크상의 통신 프로토콜을 변환해주는 역할을 하기도 한다.

## **홉**

---

- 네트워크에서 출발지와 목적지 사이에 위치한 장치를 의미하며 홉 카운트(hop count)는 데이터가 출발지와 목적지 사이에서 통과해야 하는 홉의 개수를 의미

### **홉바이홉 통신**

---

![hop_by_hop.png](hop_by_hop.png)

- 통신 장치에 있는 라우팅 테이블의 IP를 통해 시작 주소부터 시작하여 다음 IP로 계속해서 이동하는 라우팅 과정을 거쳐 패킷이 최종 목적지까지 도달하는 통신을 말한다.
- 패킷을 전송하는 라우터는 최종 목적지(B)까지의 *모든* 경로를 아는 것이 아니라, 오직 "이 패킷을 최종 목적지로 보내려면, **다음(Next Hop)에 어떤 라우터에게 넘겨야 하는가?**"만 자신의 라우팅 테이블을 보고 판단한다.
- L2 헤더 교체: 패킷을 다음 라우터(다음 홉)로 넘겨주기 위해 2계층(Ethernet) 헤더를 새로 만들어 캡슐화(통신 중간의 새 출발지-새 목적지)
- L3 헤더 보존:  3계층(IPv4) 헤더의 출발지/목적지 IP 주소는 절대 변하지 않는다. (최종 출발지와 최종 목적지)

## DHCP

---

![dhcp.png](dhcp.png)

**DHCP (Dynamic Host Configuration Protocol : 동적 호스트 구성 프로토콜)**

- 인터넷의 IP, 서브넷마스크, 기본 게이트웨이 등의 설정들을 자동적으로 제공해주는 UDP 기반 비연결형 서비스 프로토콜
- 네트워크에 사용되는 IP 주소를 DHCP 서버가 **중앙 집중식**으로 관리하는 클라이언트/서버 모델을 사용
- DHCP 지원 클라이언트는 네트워크 부팅 과정에서 DHCP 서버에 IP 주소를 요청하고 이를 얻을 수 있음

**장점**

- **자동화**: IP 주소 및 네트워크 설정이 자동으로 할당됨
- **충돌 방지**: 중복된 IP 주소 할당 문제 방지
- **효율적 관리**: 네트워크 관리자의 업무량 감소
- **유동적 IP 관리**: 임대 기간이 끝나면 IP를 회수하여 다른 장치에 재사용 가능

**단점**

- **보안 문제:** 인가되지 않은 DHCP 서버가 악의적인 네트워크 정보(예: DNS)를 배포하여 트래픽을 가로챌 수 있음
- **장애 민감:** 서버 다운 시(SPOF) 새 장치들이 IP를 할당받지 못해 네트워크 접속 장애가 발생
- **불안정한 네트워크 환경에서 문제 발생:** 패킷 손실이 잦은 환경(예: 불안정한 Wi-Fi)에서는 IP 할당/갱신 요청(UDP)이 실패할 수 있음
- **설정 오류 가능성:** 관리자가 IP 범위나 게이트웨이 정보를 잘못 설정하면, 모든 클라이언트가 오류의 영향을 받게 됨

**동작 과정**

1. **DHCP Discover**: 클라이언트가 네트워크에 연결되면, DHCP 서버를 찾기 위해 브로드캐스트 메시지를 보냄
2. **DHCP Offer**: DHCP 서버가 클라이언트에게 사용 가능한 IP 주소와 네트워크 정보를 제공
3. **DHCP Request**: 클라이언트가 특정 DHCP 서버의 제안을 수락하고 IP 주소를 요청
4. **DHCP Acknowledgement (ACK)**: DHCP 서버가 요청을 승인하고 최종 네트워크 설정 정보를 전달

**주요 개념 및 옵션**

**IP 임대(Lease) 개념**

- DHCP에서 IP 주소는 영구적으로 할당되는 것이 아니라, 일정 기간(임대 기간) 동안만 유효함
- 임대 기간이 만료되면 클라이언트는 DHCP 서버에 갱신 요청을 보내거나 새로운 IP 주소를 할당받아야 함

**DHCP 옵션**

- DHCP는 단순히 IP 주소만 제공하는 것이 아니라, 네트워크 운영에 필요한 다양한 정보를 함께 제공할 수 있음.
- 대표적인 DHCP 옵션
    - 기본 게이트웨이 (option 3)
    - DNS 서버 (option 6)
    - 서브넷 마스크 (option 1)
    - NTP 서버 (option 42)

**DHCP 범위(Scope)와 예약(Reservation)**

- **DHCP Scope**: DHCP 서버에서 특정 네트워크 범위 내에서 할당할 수 있는 IP 주소의 범위를 정의하는 설정
- **DHCP Reservation**: 특정 장치(MAC 주소 기반)에 대해 항상 동일한 IP 주소를 할당하는 기능